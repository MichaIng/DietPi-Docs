# Release Notes

## September 2021 (version 7.6)

### New Software

- [Box64](../../software/gaming/#box64) :octicons-arrow-right-16: This x86_64 userspace emulator allows you to run x86_64 binaries on an ARMv8/arm64 system. It works very similar to Box86, hence is able to use arm64 shared libraries with the x86_64 binaries, so that often no additional libraries need to be installed. Thanks to binfmt, it is invoked automatically if an x86_64 binary is tried to be executed. Many thanks to @ravenclaw900 for implementing this software title: <https://github.com/MichaIng/DietPi/pull/4625>
- [File Browser](../../software/cloud/#file-browser) :octicons-arrow-right-16: Access and manage your data from anywhere via browser with this lightweight remote file manager. Other than ownCloud and Nextcloud, it accesses the raw data on your filesystem, based on a chosen root directory, which makes it similar to Syncthing. You can setup multiple users with their own root directory and also sharing files and directories via password-protected link is possible.
- [Spotifyd](../../software/media/#spotifyd) :octicons-arrow-right-16: Spotifyd streams music just like the official client, but is more lightweight. It also supports the Spotify Connect protocol, which makes it show up as a device that can be controlled from the official clients. Many thanks to @ressu for implementing this software title: <https://github.com/MichaIng/DietPi/pull/4713>

### Improvements

- **General** :octicons-arrow-right-16: Initial detection and support for Debian 12 Bookworm (the new "testing" version) has been added to DietPi. Everyone is invited to upgrade to Bookworm to stay on bleeding edge. Just note that due to continued breaking changes coming with package upgrades, some features and software installs are broken or will break. We are happy to receive your bug report then, to have necessary changes implemented in DietPi as fast as breaking changes in Bookworm happen, until it becomes the new stable Debian release, expected in summer 2023.
- **DietPi-FS_partition_resize** :octicons-arrow-right-16: On first boot, DietPi automatically expands the root partition and filesystem to cover the full disk size. In some circumstances, e.g. on older kernel versions, it may happen that the two used commands `partprobe` and `partx -u` fail to inform the kernel about the changed partition table and hence the filesystem is not expanded. In such case, the system is now rebooted automatically once to assure that the new partition table is loaded and the filesystem is then expanded. This change affects only new images with contain DietPi v7.6 already, since this expansion is done before DietPi updates itself. Many thanks to @Dtrieb for reporting a case where the filesystem expansion failed: <https://github.com/MichaIng/DietPi/issues/4582>
- [DietPi-Drive_Manager](../../dietpi_tools/#dietpi-drive-manager) :octicons-arrow-right-16: Native Linux exFAT support is now detected and respected by skipping the obsolete FUSE driver install in case. Additionally the new `exfatprogs` are installed on Bullseye, written and implemented with Debian Bullseye along with the native Linux exFAT implementation.
- [DietPi-Drive_Manager](../../dietpi_tools/#dietpi-drive-manager) :octicons-arrow-right-16: exFAT mounts now have 775 mode and are owned by the "dietpi" group, if it was not manually removed. By default, when the FUSE driver is used, mounts have 777 mode so that all users have full access, which isn't optimal for security reasons. With native Linux exFAT support mounts have 755 mode by default, so that DietPi-Software's download and media software implementations don't have write access. "775 root:dietpi" is a good compromise if the "dietpi" group exists, matching the permissions for content directories in `/mnt/dietpi_userdata`. Many thanks to @K92Pi for reporting a related issue: <https://github.com/MichaIng/DietPi/issues/4680>
- [DietPi-Drive_Manager](../../dietpi_tools/#dietpi-drive-manager) :octicons-arrow-right-16: Added support for moving the root filesystem to a different drive on Odroid N2.
- [DietPi-AutoStart](../../dietpi_tools/#dietpi-autostart) :octicons-arrow-right-16: A new autostart option "Custom script (foreground, with auto login)" has been added, which executes the custom script `/var/lib/dietpi/dietpi-autostart/custom.sh` after being logged in with the chosen user automatically, in foreground on the main screen. To have it more reasonably separated, the previous custom script option has been changed to "Custom script (background, no auto login)", which is executed via systemd service, independently of any login state like before, but does not print to foreground console anymore. Instead output goes to journal (journalctl -u dietpi-autostart_custom) like most other systemd services do. The foreground mode now behaves like most other foreground/GUI autostart options, launches after auto login at the main screen (`TTY1`) and, if it's a long running process, it can be cancelled via `CTRL+C`, just like CAVA or `DietPi-CloudShell`. If one wants to run a custom script in foreground on the main screen before/independent of a login, placing it into `/var/lib/dietpi/postboot.d/` is another option. All contained scripts are executed at the end of the boot sequence as root user on the main screen, without any manual login required. Many thanks to @scorgn for implementing this feature: <https://github.com/MichaIng/DietPi/pull/4634>
- [DietPi-Software | **TigerVNC**](../../software/remote_desktop/#tigervnc-server) :octicons-arrow-right-16: Instead of `x11vnc`, TigerVNC own scraping server is now used for shared desktop mode, which is a bit lighter and shares a lot of libraries with the TigerVNC stand alone server package.
- [DietPi-Software | **RealVNC**](../../software/remote_desktop/#realvnc-server) :octicons-arrow-right-16: Having desktop auto login enabled does not force the shared desktop VNC mode anymore. Furthermore our `vncserver.service` does not call RealVNC `vncserver-x11-serviced.service` for the shared desktop mode, but instead the actual `vncserver-x11` executable is called directly. This has some benefits, e.g. it allows to use our service for a virtual desktop while using RealVNC service to allow connections to the shared local desktop independently. Many thanks to @K92Pi for bringing this idea to us: <https://github.com/MichaIng/DietPi/issues/4672>
- [DietPi-Software | **RealVNC**](../../software/remote_desktop/#realvnc-server) :octicons-arrow-right-16: The VNC server is now started with `VncAuth` authentication by default, which allows any VNC viewer to connect, not just RealVNC ones. Use `vncpasswd` to change the password, which is now independent of the UNIX user passwords. It defaults to the global software password on a fresh install.
- [DietPi-Software | **Amiberry**](../../software/gaming/#amiberry) :octicons-arrow-right-16: Due to changes in DietPi v7.5, enabling Amiberry fast boot won't change the TTY for boot/kernel on Raspberry Pi anymore, as they do not directly interfere with Amiberry screen output anymore. But due to this change, during screen mode changes, the raw console output is visible for a short time, which breaks the Amiga feeling. To address the issue, instead of changing the kernel command line (`cmdline`), Amiberry will now switch to a different empty TTY on startup and switch back to the main TTY when being stopped, including the case of failure. As this is achieved with the Amiberry service itself, the Amiberry standard boot option benefits from it as well, as well as manual `systemctl start amiberry` calls, all the same way, and it is not limited to the Raspberry Pi, as the previous TTY change was. Many thanks to @zompiexx for reporting this issue: <https://github.com/MichaIng/DietPi/issues/4692>
- **DietPi-Software | MPD** :octicons-arrow-right-16: The service file and default `mpd.conf` are not overwritten anymore (from Buster on), but instead the required changes are added to the default, shipped with the Debian package. This resolves some error messages on MPD startup on Bullseye and leaves most custom changes untouched on a reinstall. Furthermore, by default MPD now logs to journal, accessible via `journalctl -u mpd`. Many thanks to @maartenlangeveld for reporting the MPD startup errors: <https://github.com/MichaIng/DietPi/issues/4690>
- [DietPi-Software | **Kodi**](../../software/media/#kodi) :octicons-arrow-right-16: Our Raspberry Pi accelerated Kodi package is now installed on ARMv7 RPi systems as well.

### Bug Fixes

- **General** :octicons-arrow-right-16: Resolved an issue on ARMv7 Buster and Bullseye system, where the `haveged` entropy daemon crashes due to limited syscall permissions. This can lead to several issues, like hanging boot, hanging installs or services starts. Many thanks to @jg777 for reporting this issue: <https://github.com/MichaIng/DietPi/issues/4710>
- [DietPi-Drive_Manager](../../dietpi_tools/#dietpi-drive-manager) :octicons-arrow-right-16: Corrected false information when doing an exFAT filesystem check & repair: Until Stretch, only checking for exFAT errors is supported but not repairing them. From Buster on, both is fully supported.
- [DietPi-Drive_Manager](../../dietpi_tools/#dietpi-drive-manager) :octicons-arrow-right-16: Resolved an issue where on Odroid C2 moving the root filesystem to a different drive failed. Many thanks to @yandritos for reporting this issue: <https://github.com/MichaIng/DietPi/issues/4733>
- [DietPi-LetsEncrypt](../../dietpi_tools/#dietpi-letsencrypt) :octicons-arrow-right-16: When enabling HTTPS redirect or HSTS and ownCloud or Nextcloud are installed, the `overwrite.cli.url` setting in the `config.php` is updated accordingly to contain the primary HTTPS domain. This is required for cron jobs and the `occ/ncc` commands to access ownCloud/Nextcloud through the webserver, as the `Let's Encrypt` certificate is only valid for the external domain name and not `localhost`. Many thanks to @droogi for reporting a possibly related issue: <https://github.com/MichaIng/DietPi/issues/4353>
- [DietPi-Software | **TigerVNC**](../../software/remote_desktop/#tigervnc-server) :octicons-arrow-right-16: Resolved an issue where remote connections didn't work by default on Bullseye systems, as a different configuration file is used.
- [DietPi-Software | **LXDE**](../../software/desktop/#lxde) :octicons-arrow-right-16: Resolved an issue on Raspberry Pi where calling `lxappearance` (Customize Look and Feel) failed due to incompatible RPi desktop packages. Many thanks to @pinipon for reporting this issue: <https://github.com/MichaIng/DietPi/issues/4687>
- [DietPi-Software | **LXDE**](../../software/desktop/#lxde) :octicons-arrow-right-16: Resolved an issue on Bullseye where some icon themes could not be applied due to a missing SVG library. Many thanks to @pinipon for reporting the issue and solution: <https://github.com/MichaIng/DietPi/issues/4687>
- [DietPi-Software | **LXDE**](../../software/desktop/#lxde) :octicons-arrow-right-16: Resolved an issue where the hotkey setup didn't work because of a missing `openbox` plugin. Many thanks to @pinipon for reporting the issue and solution: <https://github.com/MichaIng/DietPi/issues/4687>
- [DietPi-Software | **Blynk**](../../software/hardware_projects/#blynk-server): Resolved an issue where the log directory may be missing, which breaks the service start, when the userdata were migrated from one system to a new one. Many thanks to @Phil1988 for reporting this issue: <https://github.com/MichaIng/DietPi/issues/4721>
- [DietPi-Software | **qBittorrent**](../../software/bittorrent/#qbittorrent) :octicons-arrow-right-16: Resolved an issue on Bullseye systems where login to the web interface was not possible with the global software password since the required hash algorithm has changed. Many thanks to [aftensleuk](https://dietpi.com/forum/u/aftensleuk/summary){: class="nospellcheck"} for reporting this issue: <https://dietpi.com/forum/t/qbittorrent-login-issue/3202/17>
- [DietPi-Software | **ReadyMedia**](../../software/media/#readymedia) :octicons-arrow-right-16: Resolved an issue on Bullseye where the service does not start unless the log directory is manually created. Due to a Debian package patch, on Bullseye logs are forced to file logging again, so that `/var/log/minidlna` again needs to exist. Many thanks to @AnzoP for reporting this issue: <https://github.com/MichaIng/DietPi/issues/4745>

As always, many smaller code performance and stability improvements, visual and spelling fixes have been done, too much to list all of them here. Check out all code changes of this release on GitHub: <https://github.com/MichaIng/DietPi/pull/4747>
